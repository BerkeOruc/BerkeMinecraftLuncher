#!/bin/bash

# BerkeMC - Advanced Minecraft Launcher
# Main Entry Point

VERSION="3.1.0"

# Check for version commands
if [ "$1" = "version" ] || [ "$1" = "--version" ] || [ "$1" = "-v" ]; then
    echo "ğŸ® BerkeMC v${VERSION}"
    echo "ğŸ“¦ Advanced Minecraft Launcher"
    echo "ğŸ”— https://github.com/BerkeOruc/berkemc"
    exit 0
fi

# Check for reinstall command
if [ "$1" = "reinstall" ] || [ "$1" = "--reinstall" ]; then
    echo "ğŸ”„ BerkeMC Yeniden Kuruluyor..."
    echo ""
    echo "Ä°ÅŸlemler:"
    echo "  1. TÃ¼m ayar dosyalarÄ± silinecek"
    echo "  2. BerkeMC paketi kaldÄ±rÄ±lacak"
    echo "  3. BerkeMC yeniden kurulacak"
    echo "  âš ï¸  Minecraft dizini (~/.minecraft/) korunacak"
    echo ""
    read -p "Devam etmek istiyor musunuz? (e/H): " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Ee]$ ]]; then
        echo "ğŸ—‘ï¸  Ayar dosyalarÄ± siliniyor..."
        rm -rf ~/.berke_minecraft_launcher/
        echo "âœ… Ayar dosyalarÄ± silindi!"
        
        echo "ğŸ“¦ Paket kaldÄ±rÄ±lÄ±yor..."
        if command -v yay &> /dev/null; then
            yay -Rns berkemc --noconfirm 2>/dev/null
        elif command -v paru &> /dev/null; then
            paru -Rns berkemc --noconfirm 2>/dev/null
        elif command -v pacman &> /dev/null; then
            sudo pacman -Rns berkemc --noconfirm 2>/dev/null
        fi
        
        echo "ğŸ“¦ Yeniden kuruluyor..."
        if command -v yay &> /dev/null; then
            yay -S berkemc --noconfirm
        elif command -v paru &> /dev/null; then
            paru -S berkemc --noconfirm
        else
            echo "âŒ Yay veya Paru bulunamadÄ±!"
            exit 1
        fi
        
        echo "âœ… BerkeMC baÅŸarÄ±yla yeniden kuruldu!"
        echo "ğŸ® Åimdi 'berkemc' yazarak baÅŸlatabilirsiniz!"
    else
        echo "âŒ Yeniden kurulum iptal edildi."
    fi
    exit 0
fi

# Check for uninstall command
if [ "$1" = "uninstall" ] || [ "$1" = "--uninstall" ]; then
    echo "ğŸ—‘ï¸  BerkeMC KaldÄ±rÄ±lÄ±yor..."
    echo ""
    echo "KaldÄ±rÄ±lacak Ã¶ÄŸeler:"
    echo "  â€¢ BerkeMC paketi"
    echo "  â€¢ Ayar dosyalarÄ±: ~/.berke_minecraft_launcher/"
    echo "  â€¢ Minecraft sÃ¼rÃ¼mleri: ~/.berke_minecraft_launcher/versions/"
    echo "  âš ï¸  Minecraft dizini (~/.minecraft/) korunacak"
    echo ""
    read -p "Devam etmek istiyor musunuz? (e/H): " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Ee]$ ]]; then
        echo "ğŸ“¦ Paket kaldÄ±rÄ±lÄ±yor..."
        
        # Uninstall package
        if command -v yay &> /dev/null; then
            yay -Rns berkemc --noconfirm
        elif command -v paru &> /dev/null; then
            paru -Rns berkemc --noconfirm
        elif command -v pacman &> /dev/null; then
            sudo pacman -Rns berkemc --noconfirm
        else
            echo "âŒ Paket yÃ¶neticisi bulunamadÄ±!"
            exit 1
        fi
        
        # Ask to remove config
        echo ""
        read -p "Ayar dosyalarÄ±nÄ± da sil? (e/H): " -n 1 -r
        echo
        if [[ $REPLY =~ ^[Ee]$ ]]; then
            echo "ğŸ—‘ï¸  Ayar dosyalarÄ± siliniyor..."
            rm -rf ~/.berke_minecraft_launcher/
            echo "âœ… Ayar dosyalarÄ± silindi!"
        fi
        
        echo "âœ… BerkeMC baÅŸarÄ±yla kaldÄ±rÄ±ldÄ±!"
    else
        echo "âŒ KaldÄ±rma iptal edildi."
    fi
    exit 0
fi

# Check for update command
if [ "$1" = "update" ] || [ "$1" = "--update" ]; then
    echo "ğŸ”„ BerkeMC gÃ¼ncelleniyor..."
    
    # Check if yay is available
    if command -v yay &> /dev/null; then
        echo "ğŸ“¦ Yay ile gÃ¼ncelleniyor..."
        yay -S berkemc --noconfirm
    elif command -v paru &> /dev/null; then
        echo "ğŸ“¦ Paru ile gÃ¼ncelleniyor..."
        paru -S berkemc --noconfirm
    else
        echo "âŒ Yay veya Paru bulunamadÄ±!"
        echo "ğŸ’¡ Manuel gÃ¼ncelleme: yay -S berkemc"
        exit 1
    fi
    
    echo "âœ… GÃ¼ncelleme tamamlandÄ±!"
    exit 0
fi

# Check for help command
if [ "$1" = "help" ] || [ "$1" = "--help" ] || [ "$1" = "-h" ]; then
    echo "ğŸ® BerkeMC v${VERSION} - Advanced Minecraft Launcher"
    echo ""
    echo "KullanÄ±m:"
    echo "  berkemc                    - Launcher'Ä± baÅŸlat"
    echo "  berkemc version, -v        - SÃ¼rÃ¼m bilgisi gÃ¶ster"
    echo "  berkemc update             - Son sÃ¼rÃ¼me gÃ¼ncelle"
    echo "  berkemc reinstall          - Temiz kurulum (ayarlar sÄ±fÄ±rlanÄ±r)"
    echo "  berkemc uninstall          - BerkeMC'yi kaldÄ±r"
    echo "  berkemc help, -h           - Bu yardÄ±m menÃ¼sÃ¼nÃ¼ gÃ¶ster"
    echo ""
    echo "Ã–zellikler:"
    echo "  ğŸš€ Ultra hÄ±zlÄ± Minecraft launcher'Ä±"
    echo "  â˜• Otomatik Java yÃ¶netimi (Java 17-25)"
    echo "  ğŸ“¥ Paralel indirme sistemi (16 thread)"
    echo "  ğŸ¨ Skin yÃ¶netimi ve Ã¶nizleme"
    echo "  ğŸ”§ Mod desteÄŸi (Forge, Fabric, OptiFine)"
    echo "  ğŸ–¥ï¸  Wayland/Hyprland tam desteÄŸi"
    echo "  ğŸ¯ Asset doÄŸrulama ve otomatik onarÄ±m"
    echo "  ğŸ“Š Performans izleme (FPS, RAM, CPU)"
    echo "  ğŸŒ Ã‡oklu dil desteÄŸi (TR/EN)"
    echo ""
    echo "Repo: https://github.com/BerkeOruc/berkemc"
    echo "AUR:  https://aur.archlinux.org/packages/berkemc"
    exit 0
fi

# Default: Start the launcher
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
cd "$SCRIPT_DIR" || exit 1
exec python3 "$SCRIPT_DIR/berke_minecraft_launcher.py" "$@"